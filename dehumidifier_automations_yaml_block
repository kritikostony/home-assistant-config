- alias: input_select.dehumidifier_fan_mode change
  trigger:
    entity_id: input_select.dehumidifier_fan_mode
    platform: state
  action:
    service: midea_dehumidifier.set_fan_speed
    data_template:
      entity_id: humidifier.midea_dehumidifier_18691697733031
      fan_speed: '{{ states.input_select.dehumidifier_fan_mode.state }}'
###
- alias: MideaDehumidifier fan speed change
  trigger:
    entity_id: humidifier.midea_dehumidifier_18691697733031
    platform: state
  action:
    service: input_select.select_option
    data_template:
      entity_id: input_select.dehumidifier_fan_mode
      option: '{{ states.humidifier.midea_dehumidifier_18691697733031.attributes.fan_speed_mode }}'
###
- alias: Set input_select.dehumidifier_fan_mode options to 'High' when state of device change to Dryer
  trigger:
    platform: template
    value_template: "{% if is_state('input_select.dehumidifier_modes', 'Dryer') %}true{% endif %}"
  action:
    service: input_select.set_options
    data_template:
      entity_id: input_select.dehumidifier_fan_mode
      options: 
        - 'High'
- alias: Revert back input_select.dehumidifier_fan_mode options when state of device change to not Dryer
  trigger:
    platform: template
    value_template: "{% if not is_state('input_select.dehumidifier_modes', 'Dryer') %}true{% endif %}"
  action:
    service: input_select.set_options
    data_template:
      entity_id: input_select.dehumidifier_fan_mode
      options:
        - 'Silent'
        - 'medium'
        - 'High'
######
- alias: input_select.dehumidifier_modes change
  trigger:
    entity_id: input_select.dehumidifier_modes
    platform: state
  action:
    service: midea_dehumidifier.set_mode
    data_template:
      entity_id: humidifier.midea_dehumidifier_18691697733031
      mode: '{{ states.input_select.dehumidifier_modes.state }}'
###
- alias: MideaDehumidifier mode change
  trigger:
    entity_id: humidifier.midea_dehumidifier_18691697733031
    platform: state
  action:
    service: input_select.select_option
    data_template:
      entity_id: input_select.dehumidifier_modes
      option: '{{ states.humidifier.midea_dehumidifier_18691697733031.attributes.mode }}'
###
- alias: Input boolean Ionizer change
  trigger:
    platform: state
    entity_id: input_boolean.dehumidifier_ionizer
  action:
    service: midea_dehumidifier.set_ion_state
    data:
      entity_id: humidifier.midea_dehumidifier_18691697733031
      ion_state: "{{ 1 if is_state('input_boolean.dehumidifier_ionizer', 'on') else 0 }}"
###
- alias: MideaDehumidifier Ion state changed
  trigger:
    platform: state
    entity_id: humidifier.midea_dehumidifier_18691697733031
  action:
    service: >
      {% if state_attr('humidifier.midea_dehumidifier_18691697733031', 'ion') == 1 %}
      input_boolean.turn_on
      {% else %}
      input_boolean.turn_off
      {% endif %}
    data:
      entity_id: input_boolean.dehumidifier_ionizer
